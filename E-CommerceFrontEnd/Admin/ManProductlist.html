
<!DOCTYPE html>

<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/malihu-custom-scrollbar-plugin/3.1.5/jquery.mCustomScrollbar.concat.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" integrity="sha512-HK5fgLBL+xu6dm/Ii3z4xhlSUyZgTT9tuc/hSrtw6uzJOvgRr2a9jyxxT1ely+B+xFAmJKVSTbpM/CuL7qxO8w==" crossorigin="anonymous" />
    <style type="text/css">
        a {
            color: black;
        }

            a:link {
                text-decoration: none;
            }

        .navfont {
            font-size: 0.9rem;
            display: none;
        }

        .wrapper {
            display: none;
        }

        a:hover {
            color: black;
        }

        @media only screen and (max-width: 805px) {
            .hide {
                display: none;
            }

            .wrapper {
                display: block;
            }

            .navfont {
                font-size: 0.9rem;
                display: block;
            }
        }
    </style>

</head>
<body>

    <header>
        <div class="wrapper">

            <nav id="sidebar" style="overflow-y:scroll">
                <div id="dismiss">
                    <i class="fas fa-arrow-left"></i>

                </div>
                <div class="sidebar-header">
                    <a href="#"><i class="fas fa-home fa-2x"></i></a>
                </div>
                <ul class="list-unstyled components">

                </ul>
                

            </nav>

        </div>
        <div class="overlay"></div>


        <nav class="navbar navbar-expand navfont1  mt-2 mb-2 navbar-light justify-content-between">
            <div class="hide">
                <ul class="navbar-nav">

                    <li class="nav-item active">
                        <a class="nav-link text-dark" href="../Admin/manCategories.html">Men <span class="sr-only">(current)</span></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-dark" href="../Admin/WomenCategories.html/2">Women</a>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link text-dark" href="../Admin/lifestylesCategories.html/3">LifeStyles</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-danger" href="../Sale/ProductSale.html">SALE</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-dark" href="../Admin/ReviewList">Review</a>
                    </li>
        
                    <li class="nav-item">
                        <a class="nav-link text-dark" href="../Admin/ProductCount">ProductCount</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-dark" href="../Admin/OrderHistory">OrderHistory</a>
                    </li>

                </ul>
            </div>
            <div><a class="navbar-brand right ml-2 text-dark font-italic" href="../Admin"><b>Home&reg</b></a></div>
            <div class="dropdown show">
                <a class="btn btn-white text-secondary dropdown-toggle" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    Report
                </a>
        
                <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                    <a class="dropdown-item" href="../Admin/mencategoryReportdetails.html">MenCategory Report</a>
                    <a class="dropdown-item" href="../Admin/womencategoryReportdetails.html">WomenCategory Report</a>
                    <a class="dropdown-item" href="../Admin/lifestylecategoryReportdetails.html">LifestyleCategory Report</a>
                </div>
            </div>
            <div class="row">
                <div class="col pl-1">
                    <a class="mr-2 text-secondary cart" href="../Admin/AddManager.html">Add Manager</a>
                    <a class="mr-2 text-secondary cart" href="../Admin/AddProduct.html">Add Product</a>
                    <a class="mr-2 text-secondary profile" href="../Admin/AdminProfile.html"><i class="fa fa-user fa-lg"></i></a>
                    <a class="text-secondary profile" href="../Logout">Logout</a>
                </div>
            </div>

        </nav>

   

        <nav class="navbar navbar-expand navfont navbar-light bg-dark mt-2">
            <div class="row">
                <div class="col">
                    <button type="button" id="sidebarCollapse" class="btn">
                        <i class="fas fa-align-left"></i>
                    </button>
                </div>
                <div class=" col  ml-5">
                    <ul class="navbar-nav ml-auto">
                        <li class="nav-item active">
                            <a class="nav-link text-light" href="../Admin/manCategories.html">Men <span class="sr-only">(current)</span></a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-light" href="../Admin/WomenCategories.html">Women</a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link text-light" href="../Admin/lifestylesCategories.html">LifeStyles</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-danger" href="../Sale/ProductSale.html">SALE</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-light" href="../Admin/ReviewList.html">Review</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-dark" href="../Admin/ProductCount.html">ProductCount</a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>
    <main>

        <hr />
        <div>
        
            <div class="container">
                <div class="row">
                    <div class="col-3">
                        <form id="frmDropDown">
                            <div class="form-group row">
                                <label for="sortby" class="col-sm-4 col-form-label">Sort by</label>
                                <div class="col-sm-8">
                                    <select class="form-control" id="sortby" name="sorted">
                                        <option value="default|@cid|@cname">Position</option>
                                        <option value="atoz|@cid|@cname">name: a to z</option>
                                        <option value="ztoa|@cid|@cname">name: z to a</option>
                                        <option value="lowtohigh|@cid|@cname">price: low to high</option>
                                        <option value="hightolow|@cid|@cname">price: high to low</option>
                                    </select>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        
        </div>
        <hr />
        <div class="container mt-4">
            <div class="row text-center maincontent">
                
        
                
        
            </div>
        </div>
        <form id="cartform" enctype="multipart/form-data" action="/Admin/UpdateProduct" method="post">
            <div id="exampleModal" class="modal" tabindex="-1" role="dialog">
                <div class="modal-dialog modal-dialog-centered" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
        
                        </div>
                        <div class="modal-body">
        
                        </div>
                    </div>
                </div>
            </div>
        </form>
        
        
        <form id="Saleform" action="/Sale/AddProductToSale" method="post">
            <div id="saleModal" class="modal" tabindex="-1" role="dialog">
                <div class="modal-dialog modal-dialog-centered" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
        
                        </div>
                        <div class="modal-body">
        
                        </div>
                    </div>
                </div>
            </div>
        </form>
        
        
        <div id="deleteModal" class="modal" tabindex="-1" role="dialog">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header deleteHeader">
        
                    </div>
                    <div class="modal-body deleteBody">
        
                    </div>
                </div>
            </div>
        </div>
        
        <script>
            $.urlParam = function(name){
            var results = new RegExp('[\?&]' + name + '=([^&#]*)').exec(window.location.href);
            return results[1] || 0;
        }
        var id = $.urlParam('id');
        var categoryname = $.urlParam('categoryname');
        $.ajax({
            url : 'http://localhost:49274/api/admin/ManProductlist',
            method: 'POST',
            headers:"Content-Type:application/json",
            data : {
                "categoryname" : categoryname,
                "id" : id
            },
            complete : function(xmlHttp, status){
                if(xmlHttp.status == 200){
                    var data = xmlHttp.responseJSON; 
                   
                    $.each(data, function(index, value){
                        
                        var image = value["ImageFile"].split('|')[0];
                        $(".maincontent").append(`
                        <div class="col-md-4"><div class="bg-hoodies" style="background-image:url('../image/${image}');"><div class="uppercontent"><div class="content2" onmous><a class="full-link" href="../Admin/Details/${value["ProductId"]}">Shop Now</a></div><div class="hoverAbleInformation"> <button onclick="EditProduct(this)" data-productID-type="${value.ProductId}" class="p-3 btn border-right border-dark" data-toggle="modal" data-target="#exampleModal"><i class="c text-secondary far fa-edit"></i></button>
                                    <button onclick="AddToSale(this)" data-productID-type="${value.Product_id}" class="p-3 btn border-right border-dark" data-toggle="modal" data-target="#saleModal">sale</button>
                                    <button onclick="DeleteProduct(this)" data-productID-type="${value.ProductId}" data-productName-type="@item.Product_name" class="btn p-3 border-right border-dark" data-toggle="modal" data-target="#deleteModal"><i class=" w text-secondary far fa-trash-alt"></i></button>
         </div></div></div><div class="details"><div class="name">${value.Product_name}</div><div class="price font-weight-bold">৳${value.UnitPrice}</div> <div class="review font-weight-bold">
                                <a href="../AdminProduct/ReviewListbyProduct?id=${value.ProductId}"><u>Total Review : ${value.Reviews.length}</u></a> | <a href="../AdminProduct/OrderListbyProduct/${value.ProductId}"><u>Total Order : </u></a>
                            </div></div></div>
                            `);
                    });
                }
            }
        });
            var product1;
            function increment() {
                document.getElementById('demoInput').stepUp();
            }
            function decrement() {
                document.getElementById('demoInput').stepDown();
            }
        
            function AddToSale(product) {
                var id = product.getAttribute("data-productID-type");
        
                $.ajax({
                    type: "POST",
                    datatype: "json",
                    url: '/Admin/GetDetails',
                    data: {
                        id: id
                    },
                    success: function (response) {
                        $(".modal-header").empty();
                        $(".modal-body").empty();
                        $(".modal-header").append(`<h5 class="modal-title">${response.Product_name}</h5><button type="button"  class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>`);
                        $(".modal-body").append(`<div class="container"><div class="row border-buttom border-dark"><div class="col-4"><img style="max-width:100%;" src="/Content/image/${response.ImageFile.split('|')[0]}" alt="product-image"></div>` +
                            `<div class="col-8"><p>${response.Product_name}</p><p>${response.Description}</p><p class="font-weight-bold">Price: ৳ ${response.UnitPrice}</p></div></div></hr>` +
                            `<div class="row"><div class="col mt-2"> <div class="form-group" id="selectformsale"><label for="SalePercentage">Sale Percentage</label><input type="number" min = 1 max = 50 required name="Amount" id = "SalePercentage" class="SalePercentage form-control"/><p class="errsale"></p></div><input type="hidden" name="Product_id" value="${response.Product_id}"/>` +
                            `</div></div ></div>`);
                        $(".modal-body").append(`<button type="submit" class="ml-3 mt-2 btn btn-primary mb-2" id="Sale">Add Sale</button>`);
                        $(".modal-body").append(`<button type = "button" class="ml-2 btn btn-secondary" data-dismiss="modal">Close </button >`);
                    }
                });
        
            }
            $(".SalePercentage").change(function () {
                alert(($(".SalePercentage").val()));
            });
            function EditProduct(product) {
                var id = product.getAttribute("data-productID-type");
        
                $.ajax({
                    type: "POST",
                    datatype: "json",
                    url: '/Admin/GetDetails',
                    data: {
                        id: id
                    },
        
                    success: function (response) {
                        $(".modal-header").append(`<h5 class="modal-title">${response.Product_name}</h5><button type="button"  class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>`);
                        $(".modal-body").append(`<div class="container"><div class="row border-buttom border-dark"><div class="col-4"><img style="max-width:100%;" src="/Content/image/${response.ImageFile.split('|')[0]}" alt="product-image"></div>` +
                            `<div class="col-8"><p>${response.Product_name}</p><p>${response.Description}</p><p class="font-weight-bold">Price: ৳ ${response.UnitPrice}</p></div></div></hr>` +
                            `<div class="row"><div class="col mt-2"> <div class="form-group" id="selectform"><label for="namefield">Product Name</label><input type="text"  name="Product_name" value="${response.Product_name}" id="namefield" class="form-control"/></div>` +
                            `<div class="form-group" id="selectform2"><label for="descriptionfield">Product Description</label><input type="text" value="${response.Description}"  name="Description" id="descriptionfield" class="form-control"/></div>` +
                            `<div class="form-group" id="selectform3"><label for="pricefield">Product Price</label><input type="text" value="${response.UnitPrice}"  name="UnitPrice" id="pricefield" class="form-control"/></div>` +
                            `<div class="form-group" id="selectform4"><label for="Pimage">Product Image</label><input class="form-control-file" type="file" id="Pimage" name="files" accept="image/*" multiple/><small class="form-text text-muted">If no file selected, previous file will stays</small></div>` +
        
                            `</div></div ></div>`);
        
                        $(".modal-body").append(`<div class="ml-3" id="errorms"></div>`);
                        $(".modal-body").append(`<button type="submit" class="ml-3 mt-2 btn btn-primary mb-2" id="update">Update</button>`);
        
                        $(".modal-body").append(`<input type = "hidden" id = "productid" name="Product_id" value=${response.Product_id}>`);
        
                        $(".modal-body").append(`<button type = "button" class="ml-2 btn btn-secondary" data-dismiss="modal">Close </button >`);
        
                        $("#pricefield").on("input", function (evt) {
                            var self = $(this);
                            self.val(self.val().replace(/[^0-9\.]/g, ''));
                            if ((evt.which != 46 || self.val().indexOf('.') != -1) && (evt.which < 48 || evt.which > 57)) {
                                evt.preventDefault();
                            }
                        });
        
                        $("#namefield").change(function () {
                            var value = $("#namefield").val();
        
                            if (value.length == 0) {
        
                                $("#selectform").append(`<p style="color:red" class="modalerror name">Product name is Required</p>`);
                            } else {
                                $(".name").remove();
                            }
                        });
                        $("#descriptionfield").change(function () {
                            var value = $("#descriptionfield").val();
        
                            if (value.length == 0) {
        
                                $("#selectform2").append(`<p style="color:red" class="modalerror desc">Description is Required</p>`);
                            } else {
                                $(".desc").remove();
                            }
                        });
                        $("#pricefield").change(function () {
                            var value = $("#pricefield").val();
        
                            if (value.length == 0) {
        
                                $("#selectform3").append(`<p style="color:red" class="modalerror unitprice">Price is Required</p>`);
                            } else {
                                if (Number(value) > 99999.99 || Number(value) <= 1) {
                                    $(".unitprice").remove();
                                    $("#selectform3").append(`<p style="color:red" class="modalerror unitprice">Price should be between 1 to 99999.99</p>`);
                                } else {
                                    $(".unitprice").remove();
                                }
        
                            }
                        });
        
                        $("#update").click(function () {
                            var i = true;
                            if ($(".modalerror").length > 0) {
                                return false;
                            } if ($("#pricefield").val().length == 0) {
                                $("#selectform3").append(`<p style="color:red" class="modalerror img">Price is Required</p>`);
                                i = false;
                            } if ($("#descriptionfield").val().length == 0) {
                                $("#selectform2").append(`<p style="color:red" class="modalerror img">Description is Required</p>`);
                                i = false;
                            } if ($("#namefield").val().length == 0) {
                                $("#selectform").append(`<p style="color:red" class="modalerror img">name is Required</p>`);
                                i = false;
                            }
                            if (i == false) {
                                return false;
                            } else {
                                return true;
                            }
                        });
        
                    }
        
        
                });
                if (!$("#exampleModal").hasClass("show")) {
                    $(".modal-header").html("");
                    $(".modal-body").html("");
                }
        
        
            }
            $(document).ready(function () {
                $('#sortby').change(function () {
                    var value = $("#sortby").val();
        
                    $.ajax({
                        type: "POST",
                        datatype: "json",
                        url: '/Admin/SortedProductList',
                        data: {
                            value: value
                        },
                        success: function (response) {
                            $(".maincontent").empty();
                            $("#sortby").val(value);
                            $.each(response, function (index, value) {
                                var image = value["ImageFile"].split("|")[0];
                                var id = value["Product_id"];
                                var name = value["Product_name"];
                                var price = value["UnitPrice"];
        
                                $(".maincontent").append(`<div class="col-md-4 deleteParent mb-5">` +
                                    `<div class="bg-hoodies" style="background-image:url('/Content/image/${image}');">` +
                                    `<div class="uppercontent">` +
                                    `<div class="content2" onmous>` +
        
                                    `<a class="full-link" href="/Product/Details/${value["Product_id"]}">Shop Now</a>` +
                                    `</div>` +
                                    `<div class="hoverAbleInformation">` +
                                     `<button onclick="EditProduct(this)" data-productID-type="${id}" class="p-3 btn border-right border-dark" data-toggle="modal" data-target="#exampleModal"><i class="c text-secondary far fa-edit"></i></button>`+
                                    `<button onclick="DeleteProduct(this)" data-productID-type="${id}" data-productName-type="${name}" class="btn p-3 border-right border-dark" data-toggle="modal" data-target="#deleteModal"><i class=" w text-secondary far fa-trash-alt"></i></button>`+
                                    `</div>` +
        
                                    `</div>` +
                                    `</div>` +
                                    `<div class="details">` +
                                    `<div class="name">` +
                                    `${name}` +
                                    `</div>` +
                                    `<div class= "price font-weight-bold">` +
                                    `৳ ${price}` +
                                    `</div >` +
                                    `<div class="review font-weight-bold">` +
                                    `<a href="/AdminProduct/ReviewListbyProduct/${value["Product_id"]}"><u>Total Review : ${value["totalreview"]}</u></a> | <a href="/AdminProduct/OrderListbyProduct/${value["Product_id"]}"><u>Total Order : ${value["totalorder"]}</u></a>` +
                                    `</div>` +
                                    `</div >` +
                                    `</div>`);
                            });
                        }
                    });
        
                });
        
            });
        
            function deleteAjax(id, callback) {
        
                $.ajax({
                    type: "POST",
                    datatype: "json",
                    url: '/Admin/DeleteProduct',
                    data: {
                        id: id
                    },
                    success: function (response) {
                        if (response == "done") {
                            callback(true);
                        }
        
                    }
                });
            }
            function DeleteProduct(product) {
                $(".deleteHeader").empty();
                $(".deleteBody").empty();
                product1 = product;
                var id = product.getAttribute("data-productID-type");
                var name = product.getAttribute("data-productName-type");
                $(".deleteHeader").append(`<h5 class="modal-title">Delete ${name}</h5><button type="button"  class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>`);
                $(".deleteBody").append(`<p style="color:red"> Confirm Delete ${name}? This can't be undo.</p>`);
                $(".deleteBody").append(`<button type="button" data-dismiss="modal" class="ml-3 mt-2 btn btn-primary mb-2" id="deletebtn">Delete</button>`);
                $(".deleteBody").append(`<button type = "button" class="ml-2 btn btn-secondary" data-dismiss="modal">Close </button >`);
                $("#deletebtn").click(function () {
                    deleteAjax(id, function (status) {
                        if (status) {
                            $(product).parents(".deleteParent").remove();
                        }
                    });
                });
            }
            
        </script>



    </main>
    <script src="../js/main.js"></script>
</body>
</html>


